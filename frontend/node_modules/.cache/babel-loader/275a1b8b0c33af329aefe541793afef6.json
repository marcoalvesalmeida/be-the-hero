{"ast":null,"code":"import _regeneratorRuntime from\"/home/marco/PESSOAL/be-the-hero/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/marco/PESSOAL/be-the-hero/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/marco/PESSOAL/be-the-hero/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Link,useHistory}from'react-router-dom';import{FiPower,FiTrash2}from'react-icons/fi';import logoImg from\"../../assets/logo.svg\";import'./styles.css';import api from'../../services/api';export default function Profile(){var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),incidents=_useState2[0],setIncidents=_useState2[1];var ong_id=localStorage.getItem('ong_id');var ong_name=localStorage.getItem('ong_name');useEffect(function(){api.get('incidents',{headers:{Authorization:ong_id}}).then(function(response){setIncidents(response.data);});},[ong_id]);function handleDelete(_x){return _handleDelete.apply(this,arguments);}function _handleDelete(){_handleDelete=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return api.delete(\"incidents/\".concat(id),{headers:{Authorization:ong_id}});case 3:setIncidents(incidents.filter(function(incident){return incident.id!==id;}));_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);alert('Não foi possível deletar, tente novamente!');case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return _handleDelete.apply(this,arguments);}function handleLogout(){localStorage.clear();history.push('/');}return/*#__PURE__*/React.createElement(\"div\",{className:\"profile-container\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"img\",{src:logoImg,alt:\"Be The Hero\"}),/*#__PURE__*/React.createElement(\"span\",null,\"Bem-vinda, \",ong_name),/*#__PURE__*/React.createElement(Link,{className:\"button\",to:\"/incidents/new\"},\"Cadastrar novo caso\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:handleLogout},/*#__PURE__*/React.createElement(FiPower,{size:18}))),/*#__PURE__*/React.createElement(\"h1\",null,\"Casos Cadastrados\"),/*#__PURE__*/React.createElement(\"ul\",null,incidents.map(function(incident){return/*#__PURE__*/React.createElement(\"li\",{key:incident.id},/*#__PURE__*/React.createElement(\"strong\",null,\"CASO:\"),/*#__PURE__*/React.createElement(\"p\",null,incident.title),/*#__PURE__*/React.createElement(\"strong\",null,\"DESCRI\\xC7\\xC3O:\"),/*#__PURE__*/React.createElement(\"p\",null,incident.description),/*#__PURE__*/React.createElement(\"strong\",null,\"VALOR:\"),/*#__PURE__*/React.createElement(\"p\",null,Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL'}).format(incident.value)),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return handleDelete(incident.id);}},/*#__PURE__*/React.createElement(FiTrash2,{size:20,color:\"#a8a8b3\"})));})));}","map":{"version":3,"sources":["/home/marco/PESSOAL/be-the-hero/frontend/src/pages/Profile/index.js"],"names":["React","useState","useEffect","Link","useHistory","FiPower","FiTrash2","api","Profile","history","incidents","setIncidents","ong_id","localStorage","getItem","ong_name","get","headers","Authorization","then","response","data","handleDelete","id","delete","filter","incident","alert","handleLogout","clear","push","logoImg","map","title","description","Intl","NumberFormat","style","currency","format","value"],"mappings":"8WAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,OAASC,OAAT,CAAkBC,QAAlB,KAAkC,gBAAlC,C,2CAGA,MAAO,cAAP,CACA,MAAOC,CAAAA,GAAP,KAAgB,oBAAhB,CAEA,cAAe,SAASC,CAAAA,OAAT,EAAmB,CAC/B,GAAMC,CAAAA,OAAO,CAAGL,UAAU,EAA1B,CAD+B,cAGGH,QAAQ,CAAC,EAAD,CAHX,wCAGxBS,SAHwB,eAGbC,YAHa,eAK/B,GAAMC,CAAAA,MAAM,CAAGC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAf,CACA,GAAMC,CAAAA,QAAQ,CAAGF,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAjB,CAEAZ,SAAS,CAAC,UAAM,CACbK,GAAG,CAACS,GAAJ,CAAQ,WAAR,CAAqB,CAClBC,OAAO,CAAE,CACNC,aAAa,CAAEN,MADT,CADS,CAArB,EAIGO,IAJH,CAIQ,SAAAC,QAAQ,CAAI,CACjBT,YAAY,CAACS,QAAQ,CAACC,IAAV,CAAZ,CACF,CAND,EAOF,CARQ,CAQP,CAACT,MAAD,CARO,CAAT,CAR+B,QAkBhBU,CAAAA,YAlBgB,gJAkB/B,iBAA4BC,EAA5B,wJAEYhB,CAAAA,GAAG,CAACiB,MAAJ,qBAAwBD,EAAxB,EAA8B,CACjCN,OAAO,CAAE,CACNC,aAAa,CAAEN,MADT,CADwB,CAA9B,CAFZ,QAQMD,YAAY,CAACD,SAAS,CAACe,MAAV,CAAiB,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACH,EAAT,GAAgBA,EAApB,EAAzB,CAAD,CAAZ,CARN,8EAUMI,KAAK,CAAC,4CAAD,CAAL,CAVN,mEAlB+B,+CAgC/B,QAASC,CAAAA,YAAT,EAAuB,CACpBf,YAAY,CAACgB,KAAb,GAEApB,OAAO,CAACqB,IAAR,CAAa,GAAb,EACF,CAED,mBACG,2BAAK,SAAS,CAAC,mBAAf,eACG,+CACG,2BAAK,GAAG,CAAEC,OAAV,CAAmB,GAAG,CAAC,aAAvB,EADH,cAEG,8CAAkBhB,QAAlB,CAFH,cAIG,oBAAC,IAAD,EAAM,SAAS,CAAC,QAAhB,CAAyB,EAAE,CAAC,gBAA5B,wBAJH,cAKG,8BAAQ,IAAI,CAAC,QAAb,CAAsB,OAAO,CAAEa,YAA/B,eACG,oBAAC,OAAD,EAAS,IAAI,CAAE,EAAf,EADH,CALH,CADH,cAWG,kDAXH,cAaG,8BACKlB,SAAS,CAACsB,GAAV,CAAe,SAAAN,QAAQ,qBACtB,0BAAI,GAAG,CAAEA,QAAQ,CAACH,EAAlB,eACG,0CADH,cAEG,6BAAIG,QAAQ,CAACO,KAAb,CAFH,cAIG,qDAJH,cAKG,6BAAIP,QAAQ,CAACQ,WAAb,CALH,cAOG,2CAPH,cAQG,6BAAIC,IAAI,CAACC,YAAL,CAAkB,OAAlB,CAA2B,CAAEC,KAAK,CAAE,UAAT,CAAqBC,QAAQ,CAAE,KAA/B,CAA3B,EAAmEC,MAAnE,CAA0Eb,QAAQ,CAACc,KAAnF,CAAJ,CARH,cAUG,8BAAQ,IAAI,CAAC,QAAb,CAAsB,OAAO,CAAE,yBAAMlB,CAAAA,YAAY,CAACI,QAAQ,CAACH,EAAV,CAAlB,EAA/B,eACG,oBAAC,QAAD,EAAU,IAAI,CAAE,EAAhB,CAAoB,KAAK,CAAC,SAA1B,EADH,CAVH,CADsB,EAAvB,CADL,CAbH,CADH,CAkCF","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { FiPower, FiTrash2 } from 'react-icons/fi';\n\nimport logoImg from '../../assets/logo.svg';\nimport './styles.css';\nimport api from '../../services/api';\n\nexport default function Profile() {\n   const history = useHistory();\n\n   const [incidents, setIncidents] = useState([]);\n\n   const ong_id = localStorage.getItem('ong_id');\n   const ong_name = localStorage.getItem('ong_name');\n\n   useEffect(() => {\n      api.get('incidents', {\n         headers: {\n            Authorization: ong_id\n         }\n      }).then(response => {\n         setIncidents(response.data);\n      });\n   },[ong_id]);\n\n   async function handleDelete(id){\n      try {\n         await api.delete(`incidents/${id}`, {\n            headers: {\n               Authorization: ong_id\n            }\n         });\n\n         setIncidents(incidents.filter(incident => incident.id !== id));\n      } catch (err) {\n         alert('Não foi possível deletar, tente novamente!');\n      }\n   }\n\n   function handleLogout(){\n      localStorage.clear();\n\n      history.push('/');\n   }\n\n   return (\n      <div className=\"profile-container\">\n         <header>\n            <img src={logoImg} alt=\"Be The Hero\" />\n            <span>Bem-vinda, {ong_name}</span>\n\n            <Link className=\"button\" to=\"/incidents/new\">Cadastrar novo caso</Link>\n            <button type=\"button\" onClick={handleLogout}>\n               <FiPower size={18} />\n            </button>\n         </header>\n\n         <h1>Casos Cadastrados</h1>\n\n         <ul>\n            { incidents.map( incident => (\n               <li key={incident.id}>\n                  <strong>CASO:</strong>\n                  <p>{incident.title}</p>\n\n                  <strong>DESCRIÇÃO:</strong>\n                  <p>{incident.description}</p>\n\n                  <strong>VALOR:</strong>\n                  <p>{Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(incident.value)}</p>\n\n                  <button type=\"button\" onClick={() => handleDelete(incident.id)}>\n                     <FiTrash2 size={20} color=\"#a8a8b3\" />\n                  </button>\n               </li>\n            )) }\n         </ul>\n      </div>\n   )\n}"]},"metadata":{},"sourceType":"module"}